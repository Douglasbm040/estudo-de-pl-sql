--* USO DO CURSOR ?
--* DESCREVER O USO DO CURSOR 
--* Você usa um cursor para buscar as linhas retornadas por uma consulta.
--* Você recupera as linhas no cursor usando uma consulta e, então, 
--* busca as linhas do cursor, uma por vez

--* CRIANDO OBJECTO
CREATE OR REPLACE TYPE PERSON AS OBJECT(
    CPF  VARCHAR(11),
    NOME VARCHAR2(15),
    SOBRENOME  VARCHAR2(30),
    IDADE  INTEGER
  
)NOT FINAL;

--* HERDANDO O OBJETO
CREATE OR REPLACE TYPE CLIENTESOBJ UNDER PERSON(
    ID  INTEGER,
    VALORCOMPRADO  FLOAT 
);

--* CRIANDO TABELA POR MEIO DE OBJETO
CREATE TABLE CLIENTE OF CLIENTESOBJ ;

--* COMANDO INSERT COM OBJETOS
INSERT INTO CLIENTE VALUES(CLIENTESOBJ('123456789','LUIZ','LIMA',30,1,100.50));
INSERT INTO CLIENTE VALUES(CLIENTESOBJ('123456729','ANA','SOUZA',30,1,100.50));
INSERT INTO CLIENTE VALUES(CLIENTESOBJ('123436789','CREUZA','FERREIRA',30,1,100.50));
INSERT INTO CLIENTE VALUES(CLIENTESOBJ('123456089','MARIA','CONCEICAO',30,1,100.50));
INSERT INTO CLIENTE VALUES(CLIENTESOBJ('122456789','OTAVIO','CORDEIRO',30,1,100.50));

--* COMANDO UPDATE COM OBJETOS
-- Update rows in a Table
Update CLIENTE
    SET VALORCOMPRADO=11233.5
WHERE NOME = 'LUIZ';

--* CRIACAO DE VETORES
CREATE OR REPLACE TYPE COLUNAS AS VARRAY(6) OF VARCHAR2(20);
CREATE OR REPLACE TYPE COLL AS VARRAY(6) OF CLIENTESOBJ;

-- ARRAY := [CLIENTE.CPF,CLIENTE.NOME,CLIENTE.SOBRENOME,CLIENTE.IDADE,CLIENTE.ID,CLIENTE.VALORCOMPRADO]
-- ARRAY(1)
--* CONSULTANDO A TABELA DE CLIENTES
SELECT * FROM CLIENTE

--* FUNCAO PARA CRIAR CURSOR
CREATE OR REPLACE FUNCTION FUNCTION_CURSOR (
   --! CAMP COLUNAS,
   --! NUMEROCAMPO INTEGER
    )
RETURN VARCHAR2
    IS
     CURSOR CURSOR_TABLE IS SELECT CPF FROM CLIENTE;
     REPOSTACURSOR VARCHAR2(50);
    BEGIN
        FOR I IN CURSOR_TABLE LOOP
            REPOSTACURSOR := I.CPF;
        END LOOP;
            RETURN REPOSTACURSOR ;
END FUNCTION_CURSOR;
/

--* VERIFICAR
SELECT FUNCTION_CURSOR() FROM DUAL;
SELECT * FROM CLIENTES


set SERVEROUTPUT on ;
DECLARE
    --! CAMP COLUNAS := COLUNAS('CPF','NOME','SOBRENOME','IDADE','ID','VALORCOMPRADO');
    --! NUMEROCAMPO INTEGER := 1;
    CURSOR CURSOR_TABLE IS
    SELECT CPF FROM CLIENTE;
BEGIN
    FOR I IN CURSOR_TABLE LOOP
        DBMS_OUTPUT.PUT_LINE(
        'CAMPO ' || I.CPF);
    END LOOP;
END;